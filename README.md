# Transporter
跨平台数据传输

## 设计思想
将一次传输过程中的总数据切分为小段数据进行传输

### 传输单元
1. 本平台传输的基本单位是帧，帧大小由协议指定
2. 帧的内容分为明文、加密两种，加密方法由使用的协议而定

### 帧的承载媒介
1. 底层物理硬件可采用以太网、WIFI、蓝牙等方式
2. 传输平台可以使用不同操作系统、不同处理器架构（最基本支持Windows、Linux、Android，x86/x86_64、arm、mips)
3. 传输方式可以使用TCP、UDP等传输层协议，也可伪装为HTTP、HTTPS、SSH等协议，也可嵌入DNS、ECHO等协议或嵌入图片中

### 帧的传输
帧传输需要根据网络状况改变传输策略，既应适应糟糕的网络环境，例如小带宽大延迟情况，也应在局域网内等网络状况良好时具有极高的性能
1. 帧传输需要经由信道，每一条下层传输连接（如TCP、UDP等）承载多条信道，信道数量由上层应用数量决定，0号信道被P2P网络占用
2. 每一条信道建立与维护需要两个节点，两个节点中间可通过第三方协议如代理等方式进行通信
3. 每一帧可经由不同信道转发（多级路由）到达目的
4. 每一组帧在两个节点传输过程中必须使用同一信道传输（防止节点频繁选择信道）
5. 每一条信道一次只能容纳一组帧
6. 每条信道使用不同的轻量级会话密钥
7. 当帧传输失败后需要通知进行重传
8. 帧的传输与回传路径可不同


### 帧的格式
1. 对帧需要进行标记
2. 每一帧都包含上一帧和下一帧的帧序号，首帧没有上一帧序号，尾帧没有下一帧序号，如果一帧足够容纳一次数据交互，则该帧没有上一帧和下一帧序号
3. 帧内包含目的节点的地址和源节点的地址
4. 如果知道传输数据总量大小，须在首帧标出

### 节点
节点之间为P2P网络
1. 新节点建立需通知其它已知节点
2. 与其它已知节点建立连接过程中需相互认证，每一个节点具有唯一私钥
3. 新节点与被通知节点认证成功后互相将对方纳入自己的节点表中作为对方的邻居存在
4. 新节点获取被通知节点的邻居节点列表，并尝试连接，连接成功后重复第三步操作
5. 节点的创建与通知需要通过帧与信道进行，使用0号信道，其它应用不能占用0号信道
6. 节点与邻居之间需定时进行存活检测，当传输帧成功后，重置定时器
7. 节点内部需维护一个路由表

